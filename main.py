import argparse
from apk_parser import extract_binary_data
from feature_extraction import extract_features
from model import predict_malware
from binary_visualizer import visualize_binary

def main():
    parser = argparse.ArgumentParser(description='Android Malware Detection using Machine Learning and Binary Visualization')
    parser.add_argument('--apk', required=True, help='Path to the APK file')
    args = parser.parse_args()

    apk_path = args.apk

    # Extract binary data from APK
    binary_data = extract_binary_data(apk_path)

    # Extract features from binary data
    features = extract_features(binary_data)

    # Predict malware using the trained model
    prediction = predict_malware(features)

    # Visualize binary data
    visualize_binary(binary_data, 'visualizations/binary_visualization.png')

    print(f"Malware Prediction: {'Malicious' if prediction else 'Benign'}")

if __name__ == '__main__':
    main()
